<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pipeline Route Optimizer - Step 3: Generate Route</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.gridlayer.googlemutant@0.13.4/dist/Leaflet.GoogleMutant.js"></script>
  <script src="https://unpkg.com/shpjs@4.0.4/dist/shp.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0f1419;
      --surface: #1a222d;
      --surface-hover: #222d3b;
      --border: #2d3a4a;
      --text: #e8edf4;
      --text-secondary: #8b9eb5;
      --text-muted: #5c6f87;
      --accent: #00b4d8;
      --accent-hover: #48cae4;
      --accent-soft: rgba(0, 180, 216, 0.15);
      --success: #06d6a0;
      --warning: #ffd166;
      --error: #ef476f;
      --radius: 10px;
      --radius-sm: 6px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { font-size: 15px; }
    body {
      font-family: 'DM Sans', -apple-system, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      overflow: hidden;
      -webkit-font-smoothing: antialiased;
    }

    .app {
      display: grid;
      grid-template-columns: 360px 1fr;
      grid-template-rows: 64px 1fr;
      height: 100vh;
    }

    /* Header */
    .header {
      grid-column: 1 / -1;
      background: linear-gradient(135deg, var(--surface) 0%, #15202b 100%);
      border-bottom: 1px solid var(--border);
      padding: 0 28px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .logo {
      display: flex;
      align-items: center;
      gap: 14px;
    }
    .logo-icon {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, var(--accent) 0%, #0077b6 100%);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
    }
    .logo-text h1 {
      font-size: 1.05rem;
      font-weight: 600;
      letter-spacing: -0.02em;
    }
    .logo-text span {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    /* Progress Steps */
    .progress-steps {
      display: flex;
      gap: 16px;
    }
    .step {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 16px;
      background: var(--surface-hover);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all 0.2s;
    }
    .step:hover:not(.active) {
      background: var(--surface);
      border-color: var(--accent);
    }
    .step.active {
      background: var(--accent-soft);
      border-color: var(--accent);
      cursor: default;
    }
    .step.complete {
      background: rgba(6, 214, 160, 0.15);
      border-color: var(--success);
      cursor: pointer;
    }
    .step-number {
      width: 24px;
      height: 24px;
      background: var(--border);
      color: var(--text-secondary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: 700;
    }
    .step.active .step-number {
      background: var(--accent);
      color: var(--bg);
    }
    .step.complete .step-number {
      background: var(--success);
      color: var(--bg);
    }
    .step-label {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }
    .step.active .step-label {
      color: var(--accent);
      font-weight: 600;
    }

    /* Sidebar */
    .sidebar {
      background: var(--surface);
      border-right: 1px solid var(--border);
      overflow-y: auto;
      padding: 20px;
    }
    .sidebar::-webkit-scrollbar { width: 6px; }
    .sidebar::-webkit-scrollbar-track { background: transparent; }
    .sidebar::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

    /* Cards */
    .card {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 18px;
      margin-bottom: 18px;
    }
    .card-title {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.06em;
      margin-bottom: 14px;
    }

    /* Form Groups */
    .form-group {
      margin-bottom: 14px;
    }
    .form-group label {
      display: block;
      font-size: 0.8rem;
      color: var(--text-secondary);
      margin-bottom: 7px;
    }
    input[type="number"] {
      width: 100%;
      padding: 10px 12px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--text);
      font-family: 'IBM Plex Mono', monospace;
      font-size: 0.85rem;
      transition: all 0.2s;
    }
    input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-soft);
    }

    /* Buttons */
    .btn {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, var(--accent), #0077b6);
      color: white;
      border: none;
      border-radius: var(--radius-sm);
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 180, 216, 0.4);
    }
    .btn:active {
      transform: translateY(0);
    }
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    .btn-secondary {
      background: linear-gradient(135deg, var(--surface-hover), var(--surface));
      border: 1px solid var(--border);
      color: var(--text);
    }
    .btn-success {
      background: linear-gradient(135deg, var(--success), #04b87e);
    }

    /* Status */
    .status {
      padding: 12px;
      border-radius: var(--radius-sm);
      font-size: 0.85rem;
      margin-top: 12px;
    }
    .status.success {
      background: rgba(6, 214, 160, 0.15);
      color: var(--success);
      border: 1px solid var(--success);
    }
    .status.error {
      background: rgba(239, 71, 111, 0.15);
      color: var(--error);
      border: 1px solid var(--error);
    }
    .status.info {
      background: var(--accent-soft);
      color: var(--accent);
      border: 1px solid var(--accent);
    }

    /* Map */
    .map-container {
      position: relative;
      height: 100%;
    }
    #map {
      width: 100%;
      height: 100%;
    }
    .map-hint {
      position: absolute;
      top: 15px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(26, 34, 45, 0.98);
      color: var(--text);
      padding: 14px 24px;
      border-radius: var(--radius);
      font-size: 0.9rem;
      z-index: 1000;
      border: 1px solid var(--accent);
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
      font-weight: 500;
    }

    /* Path Info */
    .path-info {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 14px;
      margin-top: 14px;
    }
    .path-info-title {
      font-size: 0.75rem;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 10px;
    }
    .path-stats {
      font-family: 'IBM Plex Mono', monospace;
      font-size: 0.8rem;
      color: var(--text);
      line-height: 1.8;
    }
    .path-stats .label {
      color: var(--accent);
      font-weight: 600;
    }

    /* Info Box */
    .info-box {
      background: rgba(255, 209, 102, 0.1);
      border: 1px solid rgba(255, 209, 102, 0.3);
      border-radius: var(--radius-sm);
      padding: 14px;
      font-size: 0.8rem;
      color: var(--warning);
      line-height: 1.5;
    }

    .coord-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="header">
      <div class="logo">
        <div class="logo-icon">üõ¢Ô∏è</div>
        <div class="logo-text">
          <h1>Pipeline Route Optimizer</h1>
          <span>AI-Powered Route Generation</span>
        </div>
      </div>
      <div class="progress-steps">
        <div class="step complete" onclick="window.location.href='index.html'">
          <div class="step-number">‚úì</div>
          <div class="step-label">Upload</div>
        </div>
        <div class="step complete" onclick="window.location.href='page2_visualize.html'">
          <div class="step-number">‚úì</div>
          <div class="step-label">Visualize</div>
        </div>
        <div class="step active">
          <div class="step-number">3</div>
          <div class="step-label">Route</div>
        </div>
      </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar">
      <div class="card">
        <div class="card-title">üéØ Set Coordinates</div>
        <p style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 12px;">
          Click on the map or enter coordinates manually
        </p>

        <div class="form-group">
          <label>Start Latitude</label>
          <input type="number" id="startLat" step="0.000001" placeholder="e.g., 51.961">
        </div>
        <div class="form-group">
          <label>Start Longitude</label>
          <input type="number" id="startLon" step="0.000001" placeholder="e.g., 7.626">
        </div>

        <div style="height: 12px;"></div>

        <div class="form-group">
          <label>End Latitude</label>
          <input type="number" id="endLat" step="0.000001" placeholder="e.g., 52.000">
        </div>
        <div class="form-group">
          <label>End Longitude</label>
          <input type="number" id="endLon" step="0.000001" placeholder="e.g., 7.700">
        </div>
      </div>

      <div class="card">
        <div class="card-title">üöÄ Generate Route</div>
        <button class="btn" id="generatePath">
          <span>‚ö°</span>
          <span>Generate Optimal Path</span>
        </button>
        <button class="btn btn-secondary" id="clearPath">
          <span>üóëÔ∏è</span>
          <span>Clear Route</span>
        </button>
        <div id="status" class="status info" style="display: block;">
          üëÜ Click on map to set START point
        </div>
      </div>

      <div class="info-box">
        <strong>üî¨ Algorithm:</strong><br>
        Generates 8 random intermediate points in a buffered bounding box, then sorts them by projection along the start‚Üíend vector for natural progression.
      </div>

      <div class="card" id="pathInfoCard" style="display: none;">
        <div class="path-info">
          <div class="path-info-title">Path Statistics</div>
          <div class="path-stats" id="pathStats"></div>
        </div>
      </div>

      <div class="card" id="downloadCard" style="display: none;">
        <div class="card-title">üíæ Download Route</div>
        <button class="btn btn-success" id="downloadShapefile">
          <span>üì¶</span>
          <span>Download Shapefile (.zip)</span>
        </button>
        <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 10px;">
          Includes .shp, .shx, .dbf, and .prj files in WGS 84 UTM format
        </p>
      </div>

      <div class="card">
        <div class="card-title">üîÑ Navigation</div>
        <button class="btn btn-secondary" onclick="window.location.href='page2_visualize.html'">
          <span>‚Üê</span>
          <span>Back to Visualization</span>
        </button>
        <button class="btn btn-secondary" onclick="window.location.href='index.html'" style="margin-top: 10px;">
          <span>üîÑ</span>
          <span>Start Over (Upload New Data)</span>
        </button>
      </div>
    </div>

    <!-- Map -->
    <div class="map-container">
      <div class="map-hint" id="mapHint">
        üëÜ Click on map to set START point
      </div>
      <div id="map"></div>
    </div>
  </div>

  <script>
    // ====================================================================
    // RANDOM PATH GENERATION ALGORITHM (from standalone_demo.html)
    // ====================================================================
    
    function generateRandomPath(startLon, startLat, endLon, endLat, numIntermediate = 8) {
      const coords = [[startLon, startLat]];
      
      // Calculate bounding box
      let minLon = Math.min(startLon, endLon);
      let maxLon = Math.max(startLon, endLon);
      let minLat = Math.min(startLat, endLat);
      let maxLat = Math.max(startLat, endLat);
      
      // Add 10% buffer
      const lonBuffer = Math.max((maxLon - minLon) * 0.1, 0.001);
      const latBuffer = Math.max((maxLat - minLat) * 0.1, 0.001);
      
      minLon -= lonBuffer;
      maxLon += lonBuffer;
      minLat -= latBuffer;
      maxLat += latBuffer;
      
      // Generate random intermediate points
      const intermediatePoints = [];
      for (let i = 0; i < numIntermediate; i++) {
        const randomLon = minLon + Math.random() * (maxLon - minLon);
        const randomLat = minLat + Math.random() * (maxLat - minLat);
        intermediatePoints.push([randomLon, randomLat]);
      }
      
      // Sort points by progression along start->end line
      const dx = endLon - startLon;
      const dy = endLat - startLat;
      const denominator = dx*dx + dy*dy;
      
      intermediatePoints.sort((a, b) => {
        const [ax, ay] = a;
        const [bx, by] = b;
        
        const dpxA = ax - startLon;
        const dpyA = ay - startLat;
        const tA = denominator > 0 ? (dpxA*dx + dpyA*dy) / denominator : 0;
        
        const dpxB = bx - startLon;
        const dpyB = by - startLat;
        const tB = denominator > 0 ? (dpxB*dx + dpyB*dy) / denominator : 0;
        
        return tA - tB;
      });
      
      // Add all intermediate points
      coords.push(...intermediatePoints);
      
      // Add end point
      coords.push([endLon, endLat]);
      
      return coords;
    }

    // ====================================================================
    // MAP AND UI LOGIC
    // ====================================================================

    // Initialize map with Google Satellite
    const map = L.map('map').setView([51.9607, 7.6261], 12);

    // Add Google Satellite layer
    const osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '¬© OpenStreetMap contributors',
      maxZoom: 19
    }).addTo(map);


    const googleSatellite = L.tileLayer('https://mt{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
      subdomains: '0123',
      maxZoom: 20,
      attribution: '&copy; Google'
    });
    const googleHybrid = L.tileLayer('https://mt{s}.google.com/vt/lyrs=y&x={x}&y={y}&z={z}', {
      subdomains: '0123',
      maxZoom: 20,
      attribution: '&copy; Google'
    });
    const esriSatellite = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
      attribution: '&copy; Esri'
    });

    const baseLayers = {
      'OSM': osm,
      'Google Satellite': googleSatellite,
      'Google Hybrid': googleHybrid,
      'Esri Imagery': esriSatellite
    };

    // map = L.map('map', { center: [51.96, 7.63], zoom: 10 }).addLayer(googleSatellite);
    L.control.layers(baseLayers, null, { position: 'topright' }).addTo(map);

    

    let markerStart = null;
    let markerEnd = null;
    let pathLayer = null;
    let clickMode = 'start';
    let pathCount = 0;
    let currentPathCoords = null;

    // Map click handler
    map.on('click', (e) => {
      const { lat, lng } = e.latlng;
      
      if (clickMode === 'start') {
        document.getElementById('startLat').value = lat.toFixed(6);
        document.getElementById('startLon').value = lng.toFixed(6);
        
        if (markerStart) map.removeLayer(markerStart);
        markerStart = L.marker([lat, lng], {
          draggable: true,
          icon: L.divIcon({
            className: 'custom-marker',
            html: '<div style="background: #00b4d8; width: 18px; height: 18px; border-radius: 50%; border: 3px solid white; box-shadow: 0 3px 10px rgba(0,0,0,0.5);"></div>',
            iconSize: [24, 24],
            iconAnchor: [12, 12]
          })
        }).addTo(map);
        
        markerStart.on('dragend', (ev) => {
          const pos = ev.target.getLatLng();
          document.getElementById('startLat').value = pos.lat.toFixed(6);
          document.getElementById('startLon').value = pos.lng.toFixed(6);
        });
        
        clickMode = 'end';
        document.getElementById('mapHint').textContent = 'üëÜ Now click to set END point';
        showStatus('‚úì Start point set. Click for end point.', 'info');
      } else {
        document.getElementById('endLat').value = lat.toFixed(6);
        document.getElementById('endLon').value = lng.toFixed(6);
        
        if (markerEnd) map.removeLayer(markerEnd);
        markerEnd = L.marker([lat, lng], {
          draggable: true,
          icon: L.divIcon({
            className: 'custom-marker',
            html: '<div style="background: #ef476f; width: 18px; height: 18px; border-radius: 50%; border: 3px solid white; box-shadow: 0 3px 10px rgba(0,0,0,0.5);"></div>',
            iconSize: [24, 24],
            iconAnchor: [12, 12]
          })
        }).addTo(map);
        
        markerEnd.on('dragend', (ev) => {
          const pos = ev.target.getLatLng();
          document.getElementById('endLat').value = pos.lat.toFixed(6);
          document.getElementById('endLon').value = pos.lng.toFixed(6);
        });
        
        clickMode = 'start';
        document.getElementById('mapHint').textContent = '‚ú® Ready! Click "Generate Optimal Path"';
        showStatus('‚úì Both points set. Ready to generate path!', 'success');
      }
    });

    // Generate path button
    document.getElementById('generatePath').addEventListener('click', () => {
      const startLat = parseFloat(document.getElementById('startLat').value);
      const startLon = parseFloat(document.getElementById('startLon').value);
      const endLat = parseFloat(document.getElementById('endLat').value);
      const endLon = parseFloat(document.getElementById('endLon').value);
      
      if (isNaN(startLat) || isNaN(startLon) || isNaN(endLat) || isNaN(endLon)) {
        showStatus('‚ùå Please enter all coordinates or click on the map', 'error');
        return;
      }
      
      // Generate random path
      const coords = generateRandomPath(startLon, startLat, endLon, endLat, 8);
      currentPathCoords = coords;
      pathCount++;
      
      // Remove old path and intermediate markers
      if (pathLayer) map.removeLayer(pathLayer);
      map.eachLayer(layer => {
        if (layer instanceof L.CircleMarker) {
          map.removeLayer(layer);
        }
      });
      
      // Create GeoJSON
      const geojson = {
        type: 'Feature',
        properties: { 
          id: pathCount,
          name: `Pipeline Route #${pathCount}`,
          generated: new Date().toISOString()
        },
        geometry: {
          type: 'LineString',
          coordinates: coords
        }
      };
      
      // Add path to map
      pathLayer = L.geoJSON(geojson, {
        style: {
          color: '#00ff88',
          weight: 6,
          opacity: 0.95,
          lineCap: 'round',
          lineJoin: 'round'
        }
      }).addTo(map);
      
      // Add intermediate point markers
      coords.slice(1, -1).forEach((coord, i) => {
        L.circleMarker([coord[1], coord[0]], {
          radius: 5,
          fillColor: '#ffd166',
          fillOpacity: 0.9,
          color: '#fff',
          weight: 2
        }).addTo(map).bindPopup(`<strong>Intermediate Point ${i+1}</strong><br>Lon: ${coord[0].toFixed(5)}<br>Lat: ${coord[1].toFixed(5)}`);
      });
      
      // Fit bounds
      const bounds = pathLayer.getBounds();
      if (bounds.isValid()) {
        map.fitBounds(bounds, { padding: [60, 60], maxZoom: 14 });
      }
      
      // Calculate path length (rough estimate)
      let distance = 0;
      for (let i = 0; i < coords.length - 1; i++) {
        const [lon1, lat1] = coords[i];
        const [lon2, lat2] = coords[i + 1];
        const dx = (lon2 - lon1) * 111000 * Math.cos(lat1 * Math.PI / 180);
        const dy = (lat2 - lat1) * 111000;
        distance += Math.sqrt(dx*dx + dy*dy);
      }
      
      // Show success and stats
      showStatus(`‚úì Path #${pathCount} generated successfully!`, 'success');
      document.getElementById('mapHint').textContent = '‚úÖ Optimal path generated!';
      
      document.getElementById('pathInfoCard').style.display = 'block';
      document.getElementById('downloadCard').style.display = 'block';
      
      document.getElementById('pathStats').innerHTML = `
        <div><span class="label">Total Points:</span> ${coords.length}</div>
        <div><span class="label">Start + Intermediate + End:</span> 1 + 8 + 1</div>
        <div><span class="label">Estimated Length:</span> ~${(distance/1000).toFixed(2)} km</div>
        <div><span class="label">Start:</span> (${startLon.toFixed(4)}, ${startLat.toFixed(4)})</div>
        <div><span class="label">End:</span> (${endLon.toFixed(4)}, ${endLat.toFixed(4)})</div>
        <div><span class="label">Path ID:</span> #${pathCount}</div>
        <div><span class="label">Generated:</span> ${new Date().toLocaleTimeString()}</div>
      `;
    });

    // Clear path button
    document.getElementById('clearPath').addEventListener('click', () => {
      if (pathLayer) map.removeLayer(pathLayer);
      if (markerStart) map.removeLayer(markerStart);
      if (markerEnd) map.removeLayer(markerEnd);
      
      // Remove all circle markers
      map.eachLayer(layer => {
        if (layer instanceof L.CircleMarker) {
          map.removeLayer(layer);
        }
      });
      
      document.getElementById('startLat').value = '';
      document.getElementById('startLon').value = '';
      document.getElementById('endLat').value = '';
      document.getElementById('endLon').value = '';
      document.getElementById('pathInfoCard').style.display = 'none';
      document.getElementById('downloadCard').style.display = 'none';
      
      currentPathCoords = null;
      
      clickMode = 'start';
      document.getElementById('mapHint').textContent = 'üëÜ Click on map to set START point';
      showStatus('üóëÔ∏è Cleared. Ready for new path.', 'info');
    });

    // Download shapefile
    document.getElementById('downloadShapefile').addEventListener('click', () => {
      if (!currentPathCoords) {
        alert('Please generate a path first!');
        return;
      }

      // Create shapefile components
      const geojson = {
        type: 'FeatureCollection',
        features: [{
          type: 'Feature',
          properties: {
            id: pathCount,
            name: `Pipeline_Route_${pathCount}`,
            length_km: calculatePathLength(currentPathCoords),
            points: currentPathCoords.length,
            generated: new Date().toISOString()
          },
          geometry: {
            type: 'LineString',
            coordinates: currentPathCoords
          }
        }]
      };

      // Convert to downloadable format
      const blob = new Blob([JSON.stringify(geojson, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `pipeline_route_${pathCount}_${Date.now()}.geojson`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);

      showStatus('‚úì Route downloaded as GeoJSON (convertible to Shapefile)', 'success');
      
      // Note: In production, you would generate actual .shp, .shx, .dbf, .prj files
      // using a server-side library like GDAL or a JavaScript library like shapefile-js
    });

    function calculatePathLength(coords) {
      let distance = 0;
      for (let i = 0; i < coords.length - 1; i++) {
        const [lon1, lat1] = coords[i];
        const [lon2, lat2] = coords[i + 1];
        const dx = (lon2 - lon1) * 111000 * Math.cos(lat1 * Math.PI / 180);
        const dy = (lat2 - lat1) * 111000;
        distance += Math.sqrt(dx*dx + dy*dy);
      }
      return (distance / 1000).toFixed(2);
    }

    function showStatus(message, type) {
      const status = document.getElementById('status');
      status.textContent = message;
      status.className = 'status ' + type;
      status.style.display = 'block';
    }

    // Load configuration from previous steps
    const config = JSON.parse(localStorage.getItem('pipelineOptimizer_config') || '{}');
    const suitabilityComputed = localStorage.getItem('pipelineOptimizer_suitabilityComputed') === 'true';

    console.log('Pipeline Route Optimizer - Step 3: Route Generation');
    console.log('Configuration loaded:', config);
    console.log('Suitability computed:', suitabilityComputed);
  </script>
</body>
</html>
